(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[539840],{216513:(U,H,u)=>{const A=u(936698),o=u(123894),{isPlainObject:M}=u(579985),T=u(29703),C=u(556863),{parse:g}=u(655882),O=["img","audio","video","picture","svg","object","map","iframe","embed"],K=["script","style"];function $(w,t){w&&Object.keys(w).forEach(function(F){t(w[F],F)})}function P(w,t){return{}.hasOwnProperty.call(w,t)}function J(w,t){const F=[];return $(w,function(h){t(h)&&F.push(h)}),F}function V(w){for(const t in w)if(P(w,t))return!1;return!0}function z(w){return w.map(function(t){if(!t.url)throw new Error("URL missing");return t.url+(t.w?` ${t.w}w`:"")+(t.h?` ${t.h}h`:"")+(t.d?` ${t.d}x`:"")}).join(", ")}U.exports=l,U.exports.default=l,Object.defineProperty(U.exports,"__esModule",{value:!0});const E=/^[^\0\t\n\f\r /<=>]+$/;function l(w,t,F){if(w==null)return"";let h="",R="";function q(e,s){const a=this;this.tag=e,this.attribs=s||{},this.tagPosition=h.length,this.text="",this.mediaChildren=[],this.updateParentNodeText=function(){if(m.length){const p=m[m.length-1];p.text+=a.text}},this.updateParentNodeMediaChildren=function(){m.length&&O.includes(this.tag)&&m[m.length-1].mediaChildren.push(this.tag)}}t=Object.assign({},l.defaults,t),t.parser=Object.assign({},G,t.parser),K.forEach(function(e){t.allowedTags!==!1&&(t.allowedTags||[]).indexOf(e)>-1&&!t.allowVulnerableTags&&console.warn(`

\u26A0\uFE0F Your \`allowedTags\` option includes, \`${e}\`, which is inherently
vulnerable to XSS attacks. Please remove it from \`allowedTags\`.
Or, to disable this warning, add the \`allowVulnerableTags\` option
and ensure you are accounting for this risk.

`)});const j=t.nonTextTags||["script","style","textarea","option"];let b,i;t.allowedAttributes&&(b={},i={},$(t.allowedAttributes,function(e,s){b[s]=[];const a=[];e.forEach(function(p){typeof p=="string"&&p.indexOf("*")>=0?a.push(o(p).replace(/\\\*/g,".*")):b[s].push(p)}),a.length&&(i[s]=new RegExp("^("+a.join("|")+")$"))}));const n={},f={},d={};$(t.allowedClasses,function(e,s){b&&(P(b,s)||(b[s]=[]),b[s].push("class")),n[s]=[],d[s]=[];const a=[];e.forEach(function(p){typeof p=="string"&&p.indexOf("*")>=0?a.push(o(p).replace(/\\\*/g,".*")):p instanceof RegExp?d[s].push(p):n[s].push(p)}),a.length&&(f[s]=new RegExp("^("+a.join("|")+")$"))});const r={};let k;$(t.transformTags,function(e,s){let a;typeof e=="function"?a=e:typeof e=="string"&&(a=l.simpleTransform(e)),s==="*"?k=a:r[s]=a});let c,m,I,W,X,D,Q=!1;ie();const te=new A.Parser({onopentag:function(e,s){if(t.enforceHtmlBoundary&&e==="html"&&ie(),X){D++;return}const a=new q(e,s);m.push(a);let p=!1;const S=!!a.text;let N;if(P(r,e)&&(N=r[e](e,s),a.attribs=s=N.attribs,N.text!==void 0&&(a.innerText=N.text),e!==N.tagName&&(a.name=e=N.tagName,W[c]=N.tagName)),k&&(N=k(e,s),a.attribs=s=N.attribs,e!==N.tagName&&(a.name=e=N.tagName,W[c]=N.tagName)),(t.allowedTags!==!1&&(t.allowedTags||[]).indexOf(e)===-1||t.disallowedTagsMode==="recursiveEscape"&&!V(I)||t.nestingLimit!=null&&c>=t.nestingLimit)&&(p=!0,I[c]=!0,t.disallowedTagsMode==="discard"&&j.indexOf(e)!==-1&&(X=!0,D=1),I[c]=!0),c++,p){if(t.disallowedTagsMode==="discard")return;R=h,h=""}h+="<"+e,e==="script"&&(t.allowedScriptHostnames||t.allowedScriptDomains)&&(a.innerText=""),(!b||P(b,e)||b["*"])&&$(s,function(x,v){if(!E.test(v)){delete a.attribs[v];return}let ee=!1;if(!b||P(b,e)&&b[e].indexOf(v)!==-1||b["*"]&&b["*"].indexOf(v)!==-1||P(i,e)&&i[e].test(v)||i["*"]&&i["*"].test(v))ee=!0;else if(b&&b[e]){for(const y of b[e])if(M(y)&&y.name&&y.name===v){ee=!0;let _="";if(y.multiple===!0){const Z=x.split(" ");for(const B of Z)y.values.indexOf(B)!==-1&&(_===""?_=B:_+=" "+B)}else y.values.indexOf(x)>=0&&(_=x);x=_}}if(ee){if(t.allowedSchemesAppliedToAttributes.indexOf(v)!==-1&&se(e,x)){delete a.attribs[v];return}if(e==="script"&&v==="src"){let y=!0;try{const _=ae(x);if(t.allowedScriptHostnames||t.allowedScriptDomains){const Z=(t.allowedScriptHostnames||[]).find(function(L){return L===_.url.hostname}),B=(t.allowedScriptDomains||[]).find(function(L){return _.url.hostname===L||_.url.hostname.endsWith(`.${L}`)});y=Z||B}}catch{y=!1}if(!y){delete a.attribs[v];return}}if(e==="iframe"&&v==="src"){let y=!0;try{const _=ae(x);if(_.isRelativeUrl)y=P(t,"allowIframeRelativeUrls")?t.allowIframeRelativeUrls:!t.allowedIframeHostnames&&!t.allowedIframeDomains;else if(t.allowedIframeHostnames||t.allowedIframeDomains){const Z=(t.allowedIframeHostnames||[]).find(function(L){return L===_.url.hostname}),B=(t.allowedIframeDomains||[]).find(function(L){return _.url.hostname===L||_.url.hostname.endsWith(`.${L}`)});y=Z||B}}catch{y=!1}if(!y){delete a.attribs[v];return}}if(v==="srcset")try{let y=C(x);if(y.forEach(function(_){se("srcset",_.url)&&(_.evil=!0)}),y=J(y,function(_){return!_.evil}),y.length)x=z(J(y,function(_){return!_.evil})),a.attribs[v]=x;else{delete a.attribs[v];return}}catch{delete a.attribs[v];return}if(v==="class"){const y=n[e],_=n["*"],Z=f[e],B=d[e],L=f["*"],ne=[Z,L].concat(B).filter(function(ce){return ce});if(y&&_?x=re(x,T(y,_),ne):x=re(x,y||_,ne),!x.length){delete a.attribs[v];return}}if(v==="style")try{const y=g(e+" {"+x+"}"),_=oe(y,t.allowedStyles);if(x=le(_),x.length===0){delete a.attribs[v];return}}catch{delete a.attribs[v];return}h+=" "+v,x&&x.length&&(h+='="'+Y(x,!0)+'"')}else delete a.attribs[v]}),t.selfClosing.indexOf(e)!==-1?h+=" />":(h+=">",a.innerText&&!S&&!t.textFilter&&(h+=Y(a.innerText),Q=!0)),p&&(h=R+Y(h),R="")},ontext:function(e){if(X)return;const s=m[m.length-1];let a;if(s&&(a=s.tag,e=s.innerText!==void 0?s.innerText:e),t.disallowedTagsMode==="discard"&&(a==="script"||a==="style"))h+=e;else{const p=Y(e,!1);t.textFilter&&!Q?h+=t.textFilter(p,a):Q||(h+=p)}if(m.length){const p=m[m.length-1];p.text+=e}},onclosetag:function(e){if(X)if(D--,!D)X=!1;else return;const s=m.pop();if(!s)return;if(s.tag!==e){m.push(s);return}X=t.enforceHtmlBoundary?e==="html":!1,c--;const a=I[c];if(a){if(delete I[c],t.disallowedTagsMode==="discard"){s.updateParentNodeText();return}R=h,h=""}if(W[c]&&(e=W[c],delete W[c]),t.exclusiveFilter&&t.exclusiveFilter(s)){h=h.substr(0,s.tagPosition);return}if(s.updateParentNodeMediaChildren(),s.updateParentNodeText(),t.selfClosing.indexOf(e)!==-1){a&&(h=R,R="");return}h+="</"+e+">",a&&(h=R+Y(h),R=""),Q=!1}},t.parser);return te.write(w),te.end(),h;function ie(){h="",c=0,m=[],I={},W={},X=!1,D=0}function Y(e,s){return typeof e!="string"&&(e=e+""),t.parser.decodeEntities&&(e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),s&&(e=e.replace(/"/g,"&quot;"))),e=e.replace(/&(?![a-zA-Z0-9#]{1,20};)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),s&&(e=e.replace(/"/g,"&quot;")),e}function se(e,s){for(s=s.replace(/[\x00-\x20]+/g,"");;){const S=s.indexOf("<!--");if(S===-1)break;const N=s.indexOf("-->",S+4);if(N===-1)break;s=s.substring(0,S)+s.substring(N+3)}const a=s.match(/^([a-zA-Z][a-zA-Z0-9.\-+]*):/);if(!a)return s.match(/^[/\\]{2}/)?!t.allowProtocolRelative:!1;const p=a[1].toLowerCase();return P(t.allowedSchemesByTag,e)?t.allowedSchemesByTag[e].indexOf(p)===-1:!t.allowedSchemes||t.allowedSchemes.indexOf(p)===-1}function ae(e){if(e=e.replace(/^(\w+:)?\s*[\\/]\s*[\\/]/,"$1//"),e.startsWith("relative:"))throw new Error("relative: exploit attempt");let s="relative://relative-site";for(let S=0;S<100;S++)s+=`/${S}`;const a=new URL(e,s);return{isRelativeUrl:a&&a.hostname==="relative-site"&&a.protocol==="relative:",url:a}}function oe(e,s){if(!s)return e;const a=e.nodes[0];let p;return s[a.selector]&&s["*"]?p=T(s[a.selector],s["*"]):p=s[a.selector]||s["*"],p&&(e.nodes[0].nodes=a.nodes.reduce(de(p),[])),e}function le(e){return e.nodes[0].nodes.reduce(function(s,a){return s.push(`${a.prop}:${a.value}${a.important?" !important":""}`),s},[]).join(";")}function de(e){return function(s,a){return P(e,a.prop)&&e[a.prop].some(function(S){return S.test(a.value)})&&s.push(a),s}}function re(e,s,a){return s?(e=e.split(/\s+/),e.filter(function(p){return s.indexOf(p)!==-1||a.some(function(S){return S.test(p)})}).join(" ")):e}}const G={decodeEntities:!0};l.defaults={allowedTags:["address","article","aside","footer","header","h1","h2","h3","h4","h5","h6","hgroup","main","nav","section","blockquote","dd","div","dl","dt","figcaption","figure","hr","li","main","ol","p","pre","ul","a","abbr","b","bdi","bdo","br","cite","code","data","dfn","em","i","kbd","mark","q","rb","rp","rt","rtc","ruby","s","samp","small","span","strong","sub","sup","time","u","var","wbr","caption","col","colgroup","table","tbody","td","tfoot","th","thead","tr"],disallowedTagsMode:"discard",allowedAttributes:{a:["href","name","target"],img:["src","srcset","alt","title","width","height","loading"]},selfClosing:["img","br","hr","area","base","basefont","input","link","meta"],allowedSchemes:["http","https","ftp","mailto","tel"],allowedSchemesByTag:{},allowedSchemesAppliedToAttributes:["href","src","cite"],allowProtocolRelative:!0,enforceHtmlBoundary:!1},l.simpleTransform=function(w,t,F){return F=F===void 0?!0:F,t=t||{},function(h,R){let q;if(F)for(q in t)R[q]=t[q];else R=t;return{tagName:w,attribs:R}}}},123894:U=>{"use strict";U.exports=H=>{if(typeof H!="string")throw new TypeError("Expected a string");return H.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}},132668:(U,H,u)=>{"use strict";u.d(H,{eS:()=>A,IA:()=>M,tv:()=>T,_s:()=>C});var A=function(g){return g.appid="appid",g.color="color",g.bgColor="background-color",g.background="background",g.itemProps="data-itemprops",g.itemtype="itemtype",g.mentionId="data-mention-id",g.height="height",g.itemid="itemid",g.itemscope="itemscope",g.src="src",g.style="style",g.width="width",g.alt="alt",g.mri="mri",g.stale="stale",g.type="type",g.originalSrc="originalsrc",g.cacheKey="data-cache-key",g.duration="data-duration",g.uploadProgress="data-upload-progress",g.thumbnailUploadProgress="data-thumbnail-upload-progress",g.transcriptUploadStatus="transcript-upload-status",g.dataProcessedUrl="data-processed-url",g}({});const o=["mri","type","originalsrc","stale","data-cache-key"],M=["authorname","timestamp","author","messageid","conversation","url_thumbnail","doc_id","duration_ms","type","uri","id","height","itemtype","width","itemid","v","b64","originalName","href","t","s","f","utf","latitude","longitude","alt"],T=["abbr","align","alt","axis","aria-label","bgcolor","border","cellpadding","cellspacing","class","clear","color","cols","colspan","compact","content","contenteditable","coords","data-ams-src","data-duration","data-encodingformat","data-excerpt","data-icon","data-inline-image","data-itemprops","data-preview-src","data-source-name","data-source-time","data-source-action","data-sensitivity-title","data-sensitivity-description","data-src","data-title","data-ts-imgid","data-ts-imglen","dir","face","fluid-url","headers","height","href","hreflang","hspace","id","ismap","itemid","itemprop","itemscope","itemtype","lang","language","nohref","nowrap","rel","rev","rows","rowspan","rules","scope","scrolling","shape","size","span","src","start","style","summary","target","title","type","usemap","valign","value","vspace","width",...o],C="data-ignore-semantic-link"},749684:(U,H,u)=>{"use strict";u.d(H,{S8:()=>A,FL:()=>M,tO:()=>T});var A=function(C){return C.span="span",C.mention="mention",C.sematicObject="semantic-object",C.card="card",C.readonly="readonly",C.spacer="spacer",C.video="video",C.topic="topic",C}({});const o=["mention","semantic-object","card","readonly","spacer","video","topic"],M=["a","abbr","acronym","address","area","article","aside","b","bdi","bdo","big","blockquote","br","caption","center","cite","code","col","colgroup","dd","del","dfn","dir","div","dl","dt","em","figcaption","figure","font","footer","h1","h2","h3","h4","h5","h6","header","hgroup","hr","i","img","img","ins","kbd","label","li","map","map","mark","menu","nav","ol","p","pre","q","rp","rp","rt","rt","ruby","s","samp","section","small","span","strike","strong","sub","sup","table","tbody","td","tfoot","th","thead","time","tr","tt","u","ul","var","wbr",...o],T=["a","b","blockquote","br","cite","code","em","figure","h1","h2","h3","h4","hr","i","img","li","ol","p","pre","s","span","strong","sup","table","tbody","td","tfoot","th","thead","tr","u","ul","video",...o]},391885:(U,H,u)=>{"use strict";u.d(H,{P:()=>A,o:()=>o});const A=["at","quote","legacyquote","ss","URIObject","OriginalName","FileSize","meta","i","b","s","pre","ul","ol","li","Swift","location","contacts","c","br","Title"],o=["a",...A]},539840:(U,H,u)=>{"use strict";u.d(H,{J:()=>j});var A=u(895522),o=u(216513),M=u.n(o),T=u(454402),C=u(252475),g=u(182287),O=u(132668),K=u(749684);const $=["@font-face","@font-feature-values","@keyframes","align-content","align-items","align-self","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-timing-function","animation","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","background","border-bottom-color","border-bottom-left","border-bottom-right","border-bottom-style","border-bottom-width","border-bottom","border-collapse","border-color","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-image","border-left-color","border-left-style","border-left-width","border-left","border-radius","border-right-color","border-right-style","border-right-width","border-right","border-spacing","border-style","border-top-color","border-top-left","border-top-right","border-top-style","border-top-width","border-top","border-width","border","box-decoration-break","box-shadow","break-after","break-before","break-inside","caption-side","clear","clip","color","column-count","column-fill","column-gap","column-rule-color","column-rule-style","column-rule-width","column-rule","column-span","column-width","columns","counter-increment","counter-reset","direction","display","empty-cells","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","flex","float","font-family","font-feature-settings","font-kerning","font-language-override","font-size-adjust","font-size","font-stretch","font-style","font-synthesis","font-variant-alternates","font-variant-caps","font-variant-east","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variant","font-weight","font","hanging-punctuation","height","hyphens","image-orientation","image-rendering","image-resolution","justify-content","letter-spacing","line-break","line-height","list-style-image","list-style-position","list-style-type","list-style","margin-bottom","margin-left","margin-right","margin-top","margin","marquee-direction","marquee-play-count","marquee-speed","marquee-style","max-height","max-width","min-height","min-width","object-fit","object-position","opacity","order","overflow-wrap","overflow-x","overflow-y","overflow","padding-bottom","padding-left","padding-right","padding-top","padding","tab-size","table-layout","text-align-last","text-align","text-combine-upright","text-combine-upright","text-decoration-color","text-decoration-line","text-decoration-style","text-decoration","text-indent","text-justify","text-orientation","text-shadow","text-transform","text-underline-position","unicode-bidi","user-select","vertical-align","visibility","white-space","widows","width","word-break","word-spacing","word-wrap","writing-mode"],P=["color","background-color","font-size","margin-left","margin-right"],J={img:["height","width"],video:["height","width"]};var V=u(6969),z=u(415158),E=u(391885);function l(b,i,n){return i in b?Object.defineProperty(b,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):b[i]=n,b}const G=";",w="mailto",t="\u{1F4F7} GIF",F=/<br\s*\/?>/g,h=/\n/g,R=.75,q=48;class j{stripHtml(i,n=[],f={}){return i&&M()(i,{allowedTags:n,allowedAttributes:f})}stripAnchorLinks(i){if(!i)return i;const n=M().defaults.allowedTags,f=n.indexOf("a");return f>-1&&n.splice(f,1),M()(i,{allowedTags:n})}stripAnchorLinksForTFL(i){if(!i)return i;const n=this.sanitizeHtmlConfig?.allowedTags&&this.sanitizeHtmlConfig?.allowedTags.filter(f=>f!=="a");return M()(i,{...this.sanitizeHtmlConfig,allowedTags:n})}stripAnchorLinksForSkype(i){if(!i)return i;const n=E.P,f={...this.sanitizeSkypeMessageConfig,allowedTags:n};return M()(i,f)}sanitizeHyperlinkProperties(i,n,f=!1){const d=n||i;return i=this.makeValidUrl(i,f),f&&!i.startsWith(`${w}:`)&&(i=`${w}:${i}`),{href:i,title:i,textContent:d}}buildHyperlink(i,n,f="",d=!1){const r=this._buildHyperlinkElement(i,n,d);return this.sanitizeHtml(r+f)}_addTargetAndRelAttributes(i){return(0,A.find)(this.semanticObjectSchemas,n=>n===i[O.eS.itemtype])||(i.target="_blank",i.rel="noreferrer noopener"),i}_buildHyperlinkElement(i,n,f=!1){const{href:d,title:r,textContent:k}=this.sanitizeHyperlinkProperties(i,n,f);return`<a href="${d}" title="${r}">${k}</a>`}_getIdnSafeTitle(i){let n=i;if(!i||i.startsWith("/"))return n;const f=(0,C.mH)(void 0,d=>d,i);return f&&f.hostname&&(f.hostname.startsWith("xn--")||f.hostname.indexOf(".xn--"))&&(n=f.href),n.toLowerCase()}_stripComments(i){let n="code";return(0,A.reduce)(i.split(""),(f,d,r,k)=>{switch(n){case"code":return d==="/"&&k[r+1]==="*"?(n="comment",f):`${f}${d}`;case"comment":return d==="/"&&k[r-1]==="*"&&(n="code"),f}},"")}_sanitizeStyle(i,n){const k=this._stripComments(n).replace(this.inlineStylesBlacklistRegex,G).split(G).reduce((c,m)=>{const[I,W]=m.split(":").map(D=>D.trim());if(this.enableStrictMessageSanitization?P.includes(I)||J[i]?.includes(I):$.includes(I)){const D=this.enableStrictMessageSanitization&&I==="font-size"?this._normalizeOutrangeLargeFontSize(W):W;(I!=="font-size"||!D.startsWith("0"))&&c.push(`${I}:${D}`)}return c},[]);return(0,A.join)(k,G)}_initCustomData(i,n,f){this.defaultAllowedTags=i?K.tO:K.FL,this.defaultAllowedAttributes=O.tv,this.addTags=["URIObject","Title","Swift","Description","ended","partlist","part","name","duration","OriginalName","Identifiers","Id","RecordingContent","item","RecordingStatus","AddCustomApp","DeleteCustomApp","UpgradeCustomAppV2","eventtime","initiator","target","targetName","DeprecatedTargetName","UpdateFavDefault","isDefault","value","consentinvites","friendlynames"],n&&(this.addTags=this.addTags.concat(n)),this.addAttributes=[O._s,"url_thumbnail","b64","identity","uri","v"],f&&(this.addAttributes=this.addAttributes.concat(f))}isGiphyImageElement(i){try{return/(?:^|.*\.)giphy\.com$/.test(new URL(i).hostname)}catch{return!1}}_buildSanitizeHtmlConfigForMessagePreview(){const i=this._buildSanitizeHtmlConfig();return i.allowedTags=["div","img","video"],i.allowedStyles={},i.nonTextTags=["blockquote"],i.transformTags={br:this._transformLineBreakTags,img:this._transformImg,video:this._transformVideoTag},i}_buildSanitizeHtmlConfig(){return{allowedTags:this.defaultAllowedTags.concat(this.addTags),allowedAttributes:{"*":this.defaultAllowedAttributes.concat(this.addAttributes)},allowedSchemes:this._allowedHrefProtocols,allowedSchemesByTag:{img:this._allowedSrcProtocols},parser:{lowerCaseTags:!1},nonTextTags:["style","script","textarea","ts-hint"],transformTags:{a:this._transformATag,area:this._transformAreaTag,video:this._transformVideoTag,...this.enableStrictMessageSanitization&&{div:"p"},"*":this._transformAllTags}}}_getAllowedClassesConfig(){const i=this.defaultAllowedTags.reduce((n,f)=>(n[f]=[this.allowedClassNamesRegex],n),{});return{...this.sanitizeHtmlConfig,allowedClasses:i}}_normalizeOutrangeLargeFontSize(i){let n=NaN;return i.endsWith("px")?n=parseFloat(i):i.endsWith("pt")?n=parseFloat(i)/R:i.endsWith("rem")&&(n=parseFloat(i)*10),!isNaN(n)&&n>q?"xxx-large":i}constructor(i,n=!1,f){l(this,"semanticObjectSchemas",void 0),l(this,"sanitizeHtmlConfig",void 0),l(this,"sanitizeSkypeMessageConfig",void 0),l(this,"skypeMessagePreviewSanitizeConfig",void 0),l(this,"messagePreviewSanitizeHtmlConfig",void 0),l(this,"sanitizeHtmlConfigWithClasses",void 0),l(this,"enableStrictMessageSanitization",!1),l(this,"allowedClassNamesRegex",/^[_a-zA-Z0-9-]*$/),l(this,"_validUrlRegex",/^(ht|f)tp(s?):\/\//i),l(this,"inlineStylesBlacklistRegex",/(url|attr)\([^)]*\)?/gi),l(this,"defaultAllowedTags",[]),l(this,"defaultAllowedAttributes",[]),l(this,"addTags",[]),l(this,"addAttributes",[]),l(this,"_allowedSrcProtocols",["data","cid","blob","http","https","ftp","ftps"]),l(this,"_allowedHrefProtocols",["http","https","mailto","onenote","tel","ftp","ftps","vscode","vscode-insiders","vsls"]),l(this,"sanitizeHtml",(d,r,k=!1)=>{if(!d)return d;let c=this.sanitizeHtmlConfig;r?c=this.sanitizeHtmlConfigWithClasses:k&&(c=this.messagePreviewSanitizeHtmlConfig);let m=M()(d,c);if(k){const I=["img","video"];m=this.stripHtml(m,I)}return m}),l(this,"sanitizeSkypeMessageContent",(d,r,k)=>{if(!d)return d;d=r?d.replace(F,`
`):d.replace(h,"<br/>");const c=r?this.skypeMessagePreviewSanitizeConfig:this.sanitizeSkypeMessageConfig;r&&k?.length&&(c.allowedTags=[...c.allowedTags||[],...k]);const m=M()(d,c);return r?this.stripHtml(m):m}),l(this,"sanitizeHrefUrl",(d,r=!1)=>(0,C.Jf)(d,r?[w]:this._allowedHrefProtocols)),l(this,"makeValidUrl",(d,r=!1)=>{const k=r?d.startsWith(`${w}:`)?d:`${w}:${d}`:this._validUrlRegex.test(d)?d:`https://${d}`;return this.sanitizeHrefUrl(k,r).replace(/\s/g,"%20")}),l(this,"_transformATag",(d,r={})=>(r.href&&(r.href=this.sanitizeHrefUrl(r.href),r.title=this._getIdnSafeTitle(r.href)),r=this._addTargetAndRelAttributes(r),{tagName:d,attribs:r})),l(this,"_transformAreaTag",(d,r={})=>{if(r.style){const c=r.style.replace(/position\s*:\s*(\\61|a)\s*(\\62|b)\s*(\\73|s)\s*(\\6F|o)\s*(\\6C|l)\s*(\\75|u)\s*(\\74|t)\s*(\\65|e)\s*/gi,"");r.style=c}const k=Object.keys(r).filter(c=>c!=="href").reduce((c,m)=>(c[m]=r[m],c),{});return{tagName:d,attribs:k}}),l(this,"_transformLineBreakTags",(d,r={})=>({tagName:"div",attribs:{},text:" "})),l(this,"_transformImg",(d,r={})=>{const k=r.src||"";if(this.isGiphyImageElement(k))return{tagName:"div",attribs:{},text:t};const c=r.alt;if(c){const m=r.itemtype;if(m===V.A.emoji)return{tagName:"div",attribs:{},text:c};if(m===V.A.customEmoji)return{tagName:"div",attribs:{},text:`(${c})`}}return{tagName:d,attribs:r}}),l(this,"_transformVideoTag",(d,r={})=>{const k=(0,g.bD)(r),{width:c,height:m}=(0,g.wF)(k.width,k.height);return r.width=c.toString(),r.height=m.toString(),delete r.style,(0,T.N7)(r.src)||delete r.src,{tagName:d,attribs:r}}),l(this,"_transformAllTags",(d,r)=>(r&&r.style&&(r.style=this._sanitizeStyle(d,r.style)),{tagName:d,attribs:r})),this.enableStrictMessageSanitization=n,this.semanticObjectSchemas=Object.values(V.A),this._initCustomData(n,i,f),this.sanitizeHtmlConfig=this._buildSanitizeHtmlConfig(),this.sanitizeSkypeMessageConfig=(0,z.f2)(),this.skypeMessagePreviewSanitizeConfig=(0,z.XU)(),this.messagePreviewSanitizeHtmlConfig=this._buildSanitizeHtmlConfigForMessagePreview(),this.sanitizeHtmlConfigWithClasses=this._getAllowedClassesConfig()}}},6969:(U,H,u)=>{"use strict";u.d(H,{A:()=>A});var A=function(o){return o.mention="http://schema.skype.com/Mention",o.inputExtension="http://schema.skype.com/InputExtension",o.amsVideo="http://schema.skype.com/AMSVideo",o.amsImage="http://schema.skype.com/AMSImage",o.emoji="http://schema.skype.com/Emoji",o.customEmoji="http://schema.skype.com/CustomEmoji",o.live="http://schema.skype.com/Live",o.giphy="http://schema.skype.com/Giphy",o.filesHyperlink="http://schema.skype.com/HyperLink/Files",o.hyperLink="http://schema.skype.com/HyperLink",o.reply="http://schema.skype.com/Reply",o.fluidLink="http://schema.skype.com/FluidLink",o.fluidEmbedLink="http://schema.skype.com/FluidEmbedLink",o.fluidEmbedCard="http://schema.skype.com/FluidEmbedCard",o.fluidAutoEmbedLink="http://schema.skype.com/FluidAutoEmbedLink",o.forward="http://schema.skype.com/Forward",o.cachedImage="http://schema.skype.com/CachedImage",o.scheduledMeetingCreated="http://schema.skype.com/ScheduledMeetingCreated",o.scheduledMeetingUpdated="http://schema.skype.com/ScheduledMeetingUpdated",o.scheduledMeetingCancelled="http://schema.skype.com/ScheduledMeetingCancelled",o.topic="http://schema.skype.com/Topic",o.sticker="http://schema.skype.com/Sticker",o.inlineImageCard="http://schema.skype.com/InlineImageCard",o.inlineImage="http://schema.skype.com/InlineImage",o.virtualEventsPersonalizationToken="http://schema.skype.com/VirtualEventsPersonalizationToken",o.editorCiqFile="http://schema.skype.com/EditorCiqFile",o.editorCiqPeople="http://schema.skype.com/EditorCiqPeople",o.editorCiqMeeting="http://schema.skype.com/EditorCiqMeeting",o.editorCiqEmail="http://schema.skype.com/EditorCiqEmail",o.editorCiqChat="http://schema.skype.com/EditorCiqChat",o.codeBlockEditor="http://schema.skype.com/CodeBlockEditor",o.citation="http://schema.skype.com/Citation",o.editorCiqChannel="http://schema.skype.com/EditorCiqChannel",o.defaultEntityMention="http://schema.skype.com/DefaultEntityMention",o.groupChatTitleMention="http://schema.skype.com/GroupChatTitleMention",o}({})},415158:(U,H,u)=>{"use strict";u.d(H,{cd:()=>T,F1:()=>C,eE:()=>g,xV:()=>O,Zl:()=>$,YN:()=>P,XU:()=>J,f2:()=>V});var A=u(638948),o=u(391885),M=u(132668);const T={skype_message_preview_sent_an_image:"skype_message_preview_sent_an_image",skype_message_preview_sent_a_gif:"skype_message_preview_sent_a_gif",skype_message_preview_sent_an_audio:"skype_message_preview_sent_an_audio",skype_message_preview_sent_a_file:"skype_message_preview_sent_a_file",skype_message_preview_sent_a_video:"skype_message_preview_sent_a_video",skype_message_preview_sent_a_poll:"skype_message_preview_sent_a_poll",skype_message_preview_scheduled_call:"skype_message_preview_scheduled_call",skype_message_preview_sent_a_location:"skype_message_preview_sent_a_location",skype_message_preview_sent_a_contact:"skype_message_preview_sent_a_contact",lobby_chat_everyone_tab_label:"lobby_chat_everyone_tab_label",skype_message_preview_emoji_fallback:"skype_message_preview_emoji_fallback"},C=(z,E={})=>{const l=E.type,G=E.utf||E.alt,w=T.skype_message_preview_emoji_fallback;return G?{tagName:"div",attribs:{},text:G}:l?{tagName:"div",attribs:{},text:(0,A.t)(l)||w}:{tagName:"div",attribs:{},text:w}},g=(z,E={})=>({tagName:"div",attribs:{},text:E?.latitude&&E?.longitude?T.skype_message_preview_sent_a_location:""}),O=(z,E={})=>({tagName:"div",attribs:{},text:T.skype_message_preview_sent_a_contact}),K=(z,E={})=>({tagName:"div",attribs:{},text:" "}),$=(z,E={},l)=>E?.id==="*"||E?.id==="_*_"?{tagName:z,attribs:E,text:T.lobby_chat_everyone_tab_label}:{tagName:z,attribs:E,text:l},P=(z,E={})=>{let l="";switch(E.type?.split("/")[0]){case"Picture.1":case"Sticker.1":l=T.skype_message_preview_sent_an_image;break;case"SWIFT.1":l=T.skype_message_preview_sent_a_gif;break;case"Audio.1":l=T.skype_message_preview_sent_an_audio;break;case"File.1":l=T.skype_message_preview_sent_a_file;break;case"Video.1":l=T.skype_message_preview_sent_a_video;break;case"Poll":l=T.skype_message_preview_sent_a_poll;break;case"ScheduledCallInvite.1":l=T.skype_message_preview_scheduled_call;break}return{tagName:"div",attribs:{},text:l}};function J(){const z=V();return z.allowedTags=["div","ss","p","URIObject","contacts","location","at","br"],z.allowedStyles={},z.nonTextTags=["quote"],z.transformTags={ss:C,URIObject:P,location:g,contacts:O,at:$,br:K},z}function V(){return{allowedTags:o.o,allowedAttributes:{"*":M.IA},parser:{lowerCaseTags:!1}}}}}]);

//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/539840-0c431662dfa91abb.js.map